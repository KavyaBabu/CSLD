"use client";

import { Page } from "@arqiva/react-component-lib";
import QueryParamsUrlProvider from "@/app/_components/QueryParamsUrlProvider";
import DashboardInner, { DashboardFilters } from "./Inner";
import LeakageListPage from "./widgets/leakageList/page";
import { useEffect, useState } from "react";
import styles from "./index.module.css";

const DashboardPage = () => {
  const [dashboardFilters, setDashboardFilters] = useState<DashboardFilters>({});
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
  }, []);

  if (!mounted) return null;

  return (
    <Page.Root>
      <QueryParamsUrlProvider initialParams={{}}>
        <main className={styles.dashboard__main}>
          {/* Sticky filter bar inside main container */}
          <div className={styles.dashboard__filters_bar_sticky}>
            <h1 className={styles.dashboardTitle}>Dashboard</h1>
            <DashboardInner.FiltersBar onFiltersChange={setDashboardFilters} />
          </div>
          <div className={styles.dashboard__content_wrapper}>
            <DashboardInner.Content />
            <div className={styles["dashboard--full-width"]}>
              <h2 className={styles["dashboard__section-heading"]}>
                Leakage List
              </h2>
              <LeakageListPage dashboardFilters={dashboardFilters} />
            </div>
          </div>
        </main>
      </QueryParamsUrlProvider>
    </Page.Root>
  );
};

export default DashboardPage;


:root {
  --dashboard-bar-padding: 2rem;
  --dashboard-bar-radius: 2rem;
  --dashboard-bar-shadow: 0 2px 8px rgb(0 0 0 / 0.07);
  --dashboard-bar-bg: #fff;
}

/* Main content area */
.dashboard__main {
  position: relative;
  width: 100%;
  min-height: 100vh;
  background: #fafbfc;
}

/* Sticky filters bar (inside main, never over sidebar) */
.dashboard__filters_bar_sticky {
  position: sticky;
  top: 0;
  z-index: 20;
  background: var(--dashboard-bar-bg);
  box-shadow: var(--dashboard-bar-shadow);
  border-radius: var(--dashboard-bar-radius) var(--dashboard-bar-radius) 0 0;
  padding: var(--dashboard-bar-padding);
  margin-bottom: 1.5rem;
  /* If you want a border: border-bottom: 1px solid #e5e7eb; */
}

.dashboardTitle {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 1.25rem;
}

.dashboard__content_wrapper {
  width: 100%;
  /* No top padding needed; sticky bar sits above naturally */
}

.dashboard__section-heading {
  color: var(--grey-900, #111827);
  font-size: var(--text-xl, 1.25rem);
  font-weight: var(--font-semibold, 600);
  line-height: 1.5;
  margin-bottom: var(--spacing-lg, 1rem);
}

.dashboard--full-width {
  width: 100%;
}

.dashboard__split-row {
  display: grid;
  gap: var(--spacing-xl, 1.5rem);
  grid-template-columns: 60% 40%;
  width: 100%;
}

.dashboard__main-column,
.dashboard__side-column {
  min-width: 0;
}

/* Responsive tweaks */
@media (max-width: 1024px) {
  .dashboard__split-row {
    gap: var(--spacing-lg, 1rem);
    grid-template-columns: 65% 35%;
  }
}

@media (max-width: 768px) {
  .dashboard__filters_bar_sticky {
    padding: 1rem;
    border-radius: 0 0 var(--dashboard-bar-radius) var(--dashboard-bar-radius);
  }
  .dashboard__content_wrapper {
    padding-left: var(--spacing-md);
    padding-right: var(--spacing-md);
  }
}

/* Make sure popovers are above sticky bar */
[data-radix-popover-content],
[data-radix-dialog-content],
.popover-content,
[role="dialog"] {
  z-index: 1000 !important;
}



